<div class="page-header">
  <button mat-raised-button color="primary" (click)="openCreateAppointmentDialog()">
    + Create Appointment
  </button>
</div>


<mat-accordion>

    <mat-expansion-panel hideToggle>
        <mat-expansion-panel-header>
            <mat-panel-title>Available Slots</mat-panel-title>
            <mat-panel-description>Group Appointments</mat-panel-description>
        </mat-expansion-panel-header>


        <div *ngIf="groupLoading" class="loading-container">
            <p>Loading group appointments...</p>
        </div>


        <div *ngIf="groupError" class="error-container">
            <p class="error-message">{{ groupError }}</p>
            <button mat-raised-button color="primary" (click)="loadGroupAppointments()">
                Retry
            </button>
        </div>


        <div *ngIf="!groupLoading && !groupError && groupAppointments.length === 0" class="no-data-container">
            <p>No group appointments found.</p>
        </div>


        <div *ngIf="!groupLoading && !groupError && groupAppointments.length > 0" class="instructors-row">
            <mat-card 
                *ngFor="let appointment of groupAppointments" 
                class="example-card" 
                appearance="outlined">
                <mat-card-header>
                    <mat-card-title>
                        {{ "Group " + appointment.groupId + " : " + (appointment.groupName || 'Unnamed Group') }}
                    </mat-card-title>
                    <mat-card-subtitle>
                        Instructor ID: {{ appointment.instructorId || 'N/A' }}
                    </mat-card-subtitle>
                </mat-card-header>
                
                <mat-card-content>
                    <p>
                        <strong>Time:</strong> {{ formatTime(appointment.startTime) }} - {{ formatTime(appointment.endTime) }}<br>
                        <strong>Max Participants:</strong> {{ appointment.maxLimit || 'N/A' }}<br>
                        <strong>Description:</strong> {{ appointment.description || 'No description available' }}<br>
                        <strong>Created:</strong> {{ formatDate(appointment.createdAt) }}
                    </p>
                </mat-card-content>
                
                <mat-card-actions>
                    <button mat-button color="warn" (click)="deleteGroupAppointment(appointment.groupId)">
                        Delete Appointment
                    </button>
                </mat-card-actions>
            </mat-card>
        </div>
    </mat-expansion-panel>


    <mat-expansion-panel hideToggle>
        <mat-expansion-panel-header>
            <mat-panel-title>Available Slots</mat-panel-title>
            <mat-panel-description>Individual Appointments</mat-panel-description>
        </mat-expansion-panel-header>


        <div *ngIf="individualLoading" class="loading-container">
            <p>Loading individual appointments...</p>
        </div>


        <div *ngIf="individualError" class="error-container">
            <p class="error-message">{{ individualError }}</p>
            <button mat-raised-button color="primary" (click)="loadIndividualAppointments()">
                Retry
            </button>
        </div>


        <div *ngIf="!individualLoading && !individualError && individualAppointments.length === 0" class="no-data-container">
            <p>No individual appointments found.</p>
        </div>


        <div *ngIf="!individualLoading && !individualError && individualAppointments.length > 0" class="instructors-row">
            <mat-card 
                *ngFor="let appointment of individualAppointments" 
                class="example-card" 
                appearance="outlined">
                <mat-card-header>
                    <mat-card-title>{{ appointment.description || 'Individual Appointment' }}</mat-card-title>
                    <mat-card-subtitle>Instructor ID: {{ appointment.instructorId }}</mat-card-subtitle>
                </mat-card-header>
                
                <mat-card-content>
                    <p>
                        <strong>Date:</strong> {{ formatFullDate(appointment.appointmentDate) }}<br>
                        <strong>Time:</strong> {{ formatTime(appointment.startTime) }} - {{ formatTime(appointment.endTime) }}<br>
                        <strong>Location:</strong> {{ appointment.location || 'N/A' }}<br>
                        <strong>Status:</strong> {{ appointment.status || 'available' }}<br>
                        <strong>Created:</strong> {{ formatDate(appointment.createdAt) }}
                    </p>
                </mat-card-content>
                
                <mat-card-actions>
                    <button mat-button color="warn" (click)="deleteIndividualAppointment(appointment.appointmentId)">
                        Delete Appointment
                    </button>
                </mat-card-actions>
            </mat-card>
        </div>
    </mat-expansion-panel>
</mat-accordion>